<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lj.iot.biz.db.smart.mapper.SkillEntityEntryMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.lj.iot.biz.db.smart.entity.SkillEntityEntry">
        <id column="id" property="id" />
        <result column="intent_name" property="intentName" />
        <result column="entity_key" property="entityKey" />
        <result column="entry_key" property="entryKey" />
        <result column="entry_name" property="entryName" />
        <result column="thing_model_property" property="thingModelProperty" javaType="com.lj.iot.common.base.dto.ThingModelProperty"
                typeHandler="com.baomidou.mybatisplus.extension.handlers.FastjsonTypeHandler"/>
        <result column="key_code" property="keyCode" />
    </resultMap>

    <select id="customPage" resultMap="BaseResultMap">
        SELECT * FROM skill_entity_entry
        <where>
            <if test="params.intentName!=null and params.intentName!=''">
                and intent_name= #{params.intentName}
            </if>
            <if test="params.entityKey!=null and params.entityKey!=''">
                and entity_key= #{params.entityKey}
            </if>
            <if test="params.search!=null and params.search!=''">
                and (intent_name LIKE CONCAT(#{params.search},"%")
                or entity_key LIKE CONCAT(#{params.search},"%")
                or entry_key LIKE CONCAT(#{params.search},"%")
                or entry_name LIKE CONCAT(#{params.search},"%")
                )
            </if>
        </where>
        ORDER BY id DESC
    </select>
</mapper>
